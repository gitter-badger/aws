general:
  branches:
    only:
      - master
      - dev
      - /feature-.*/
      - /test-.*/

machine:
  services:
    - docker
  environment:
    cd_app: 'VGH'
    cd_group: 'DEV'
    cd_config: 'CodeDeployDefault.OneAtATime'
    cd_bucket: 'vladgh'
    cd_key: 'vgh'
    cd_bundle: 'zip'

dependencies:
  pre:
    - scripts/prepare.sh:
        timeout: 300
  override:
    - scripts/run.sh:
        timeout: 300

test:
  override:
    - scripts/validate.sh:
        timeout: 300

deployment:
  dev:
    branch: dev
    commands: ./scripts/deploy.sh
  production:
    branch: master
    commands: ./scripts/deploy.sh
